import{H as he,I as wt,S as we,J as Ke,K as $t,h as H,l as S,m as B,u as G,n as E,L as St,M as qe,N as Tt,O as He,P as Je,Q as kt,p as $e,b as w,c as k,z as _,v as a,d as F,t as x,y as L,G as Y,g as T,f as O,w as A,x as Ft,E as N,A as X,B as We,R as P,T as ce,U as At,r as Xe,F as Pt,D as Ct,V as ze,W as K,e as D,X as Et,Y as Lt,Z as Ut,$ as Dt,a0 as Ot,a1 as jt,a2 as fe,a3 as Se,a4 as Rt,a5 as Bt,s as Te,a6 as It,a7 as Nt,a8 as xt,a9 as Mt,aa as ke,ab as Fe,_ as Gt,ac as Kt,o as qt,a as Ht,ad as Jt,ae as de}from"./index-a6138166.js";import{u as Z}from"./el-button-0b292968.js";import{E as Wt}from"./el-overlay-fbca3f1f.js";import{b as Xt,a as Ve,i as Ye,c as zt,d as Vt,o as Yt,k as Qe,g as Ze,s as Qt,e as Zt,f as en,U as Ae,h as ge,n as Q,j as et,l as tn,S as nn,m as rn,t as ye,p as sn,q as an}from"./event-314bb7a2.js";import{i as tt}from"./focus-trap-8a1942e5.js";var Pe=Object.create,on=function(){function e(){}return function(t){if(!he(t))return{};if(Pe)return Pe(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();const ln=on;function un(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}function cn(e,t){for(var n=-1,r=e==null?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e}function ee(e,t,n,r){var s=!n;n||(n={});for(var o=-1,i=t.length;++o<i;){var c=t[o],h=r?r(n[c],e[c],c,n,e):void 0;h===void 0&&(h=e[c]),s?Xt(n,c,h):Ve(n,c,h)}return n}function fn(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var dn=Object.prototype,pn=dn.hasOwnProperty;function hn(e){if(!he(e))return fn(e);var t=Ye(e),n=[];for(var r in e)r=="constructor"&&(t||!pn.call(e,r))||n.push(r);return n}function ve(e){return zt(e)?Vt(e,!0):hn(e)}var gn=Yt(Object.getPrototypeOf,Object);const nt=gn;function yn(e,t){return e&&ee(t,Qe(t),e)}function vn(e,t){return e&&ee(t,ve(t),e)}var rt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ce=rt&&typeof module=="object"&&module&&!module.nodeType&&module,mn=Ce&&Ce.exports===rt,Ee=mn?wt.Buffer:void 0,Le=Ee?Ee.allocUnsafe:void 0;function bn(e,t){if(t)return e.slice();var n=e.length,r=Le?Le(n):new e.constructor(n);return e.copy(r),r}function _n(e,t){return ee(e,Ze(e),t)}var wn=Object.getOwnPropertySymbols,$n=wn?function(e){for(var t=[];e;)Zt(t,Ze(e)),e=nt(e);return t}:Qt;const st=$n;function Sn(e,t){return ee(e,st(e),t)}function Tn(e){return en(e,ve,st)}var kn=Object.prototype,Fn=kn.hasOwnProperty;function An(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&Fn.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function me(e){var t=new e.constructor(e.byteLength);return new Ae(t).set(new Ae(e)),t}function Pn(e,t){var n=t?me(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}var Cn=/\w*$/;function En(e){var t=new e.constructor(e.source,Cn.exec(e));return t.lastIndex=e.lastIndex,t}var Ue=we?we.prototype:void 0,De=Ue?Ue.valueOf:void 0;function Ln(e){return De?Object(De.call(e)):{}}function Un(e,t){var n=t?me(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var Dn="[object Boolean]",On="[object Date]",jn="[object Map]",Rn="[object Number]",Bn="[object RegExp]",In="[object Set]",Nn="[object String]",xn="[object Symbol]",Mn="[object ArrayBuffer]",Gn="[object DataView]",Kn="[object Float32Array]",qn="[object Float64Array]",Hn="[object Int8Array]",Jn="[object Int16Array]",Wn="[object Int32Array]",Xn="[object Uint8Array]",zn="[object Uint8ClampedArray]",Vn="[object Uint16Array]",Yn="[object Uint32Array]";function Qn(e,t,n){var r=e.constructor;switch(t){case Mn:return me(e);case Dn:case On:return new r(+e);case Gn:return Pn(e,n);case Kn:case qn:case Hn:case Jn:case Wn:case Xn:case zn:case Vn:case Yn:return Un(e,n);case jn:return new r;case Rn:case Nn:return new r(e);case Bn:return En(e);case In:return new r;case xn:return Ln(e)}}function Zn(e){return typeof e.constructor=="function"&&!Ye(e)?ln(nt(e)):{}}var er="[object Map]";function tr(e){return Ke(e)&&ge(e)==er}var Oe=Q&&Q.isMap,nr=Oe?et(Oe):tr;const rr=nr;var sr="[object Set]";function ar(e){return Ke(e)&&ge(e)==sr}var je=Q&&Q.isSet,or=je?et(je):ar;const ir=or;var lr=1,ur=2,cr=4,at="[object Arguments]",fr="[object Array]",dr="[object Boolean]",pr="[object Date]",hr="[object Error]",ot="[object Function]",gr="[object GeneratorFunction]",yr="[object Map]",vr="[object Number]",it="[object Object]",mr="[object RegExp]",br="[object Set]",_r="[object String]",wr="[object Symbol]",$r="[object WeakMap]",Sr="[object ArrayBuffer]",Tr="[object DataView]",kr="[object Float32Array]",Fr="[object Float64Array]",Ar="[object Int8Array]",Pr="[object Int16Array]",Cr="[object Int32Array]",Er="[object Uint8Array]",Lr="[object Uint8ClampedArray]",Ur="[object Uint16Array]",Dr="[object Uint32Array]",$={};$[at]=$[fr]=$[Sr]=$[Tr]=$[dr]=$[pr]=$[kr]=$[Fr]=$[Ar]=$[Pr]=$[Cr]=$[yr]=$[vr]=$[it]=$[mr]=$[br]=$[_r]=$[wr]=$[Er]=$[Lr]=$[Ur]=$[Dr]=!0;$[hr]=$[ot]=$[$r]=!1;function V(e,t,n,r,s,o){var i,c=t&lr,h=t&ur,f=t&cr;if(n&&(i=s?n(e,r,s,o):n(e)),i!==void 0)return i;if(!he(e))return e;var m=$t(e);if(m){if(i=An(e),!c)return un(e,i)}else{var y=ge(e),u=y==ot||y==gr;if(tn(e))return bn(e,c);if(y==it||y==at||u&&!s){if(i=h||u?{}:Zn(e),!c)return h?Sn(e,vn(i,e)):_n(e,yn(i,e))}else{if(!$[y])return s?e:{};i=Qn(e,y,c)}}o||(o=new nn);var g=o.get(e);if(g)return g;o.set(e,i),ir(e)?e.forEach(function(b){i.add(V(b,t,n,b,e,o))}):rr(e)&&e.forEach(function(b,d){i.set(d,V(b,t,n,d,e,o))});var l=f?h?Tn:rn:h?ve:Qe,v=m?void 0:l(e);return cn(v||e,function(b,d){v&&(d=b,b=e[d]),Ve(i,d,V(b,t,n,d,e,o))}),i}var Or=1,jr=4;function Re(e){return V(e,Or|jr)}const Rr=H({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:e=>e>=0&&e<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:{type:Boolean,default:!1},duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:S(String),default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:S([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:S(Function),default:e=>`${e}%`}}),Br=["aria-valuenow"],Ir={viewBox:"0 0 100 100"},Nr=["d","stroke","stroke-width"],xr=["d","stroke","opacity","stroke-linecap","stroke-width"],Mr={key:0},Gr=B({name:"ElProgress"}),Kr=B({...Gr,props:Rr,setup(e){const t=e,n={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},r=G("progress"),s=E(()=>({width:`${t.percentage}%`,animationDuration:`${t.duration}s`,backgroundColor:j(t.percentage)})),o=E(()=>(t.strokeWidth/t.width*100).toFixed(1)),i=E(()=>["circle","dashboard"].includes(t.type)?Number.parseInt(`${50-Number.parseFloat(o.value)/2}`,10):0),c=E(()=>{const p=i.value,U=t.type==="dashboard";return`
          M 50 50
          m 0 ${U?"":"-"}${p}
          a ${p} ${p} 0 1 1 0 ${U?"-":""}${p*2}
          a ${p} ${p} 0 1 1 0 ${U?"":"-"}${p*2}
          `}),h=E(()=>2*Math.PI*i.value),f=E(()=>t.type==="dashboard"?.75:1),m=E(()=>`${-1*h.value*(1-f.value)/2}px`),y=E(()=>({strokeDasharray:`${h.value*f.value}px, ${h.value}px`,strokeDashoffset:m.value})),u=E(()=>({strokeDasharray:`${h.value*f.value*(t.percentage/100)}px, ${h.value}px`,strokeDashoffset:m.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),g=E(()=>{let p;return t.color?p=j(t.percentage):p=n[t.status]||n.default,p}),l=E(()=>t.status==="warning"?St:t.type==="line"?t.status==="success"?qe:Tt:t.status==="success"?He:Je),v=E(()=>t.type==="line"?12+t.strokeWidth*.4:t.width*.111111+2),b=E(()=>t.format(t.percentage));function d(p){const U=100/p.length;return p.map((C,I)=>$e(C)?{color:C,percentage:(I+1)*U}:C).sort((C,I)=>C.percentage-I.percentage)}const j=p=>{var U;const{color:R}=t;if(kt(R))return R(p);if($e(R))return R;{const C=d(R);for(const I of C)if(I.percentage>p)return I.color;return(U=C[C.length-1])==null?void 0:U.color}};return(p,U)=>(w(),k("div",{class:_([a(r).b(),a(r).m(p.type),a(r).is(p.status),{[a(r).m("without-text")]:!p.showText,[a(r).m("text-inside")]:p.textInside}]),role:"progressbar","aria-valuenow":p.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[p.type==="line"?(w(),k("div",{key:0,class:_(a(r).b("bar"))},[F("div",{class:_(a(r).be("bar","outer")),style:x({height:`${p.strokeWidth}px`})},[F("div",{class:_([a(r).be("bar","inner"),{[a(r).bem("bar","inner","indeterminate")]:p.indeterminate},{[a(r).bem("bar","inner","striped")]:p.striped},{[a(r).bem("bar","inner","striped-flow")]:p.stripedFlow}]),style:x(a(s))},[(p.showText||p.$slots.default)&&p.textInside?(w(),k("div",{key:0,class:_(a(r).be("bar","innerText"))},[L(p.$slots,"default",{percentage:p.percentage},()=>[F("span",null,Y(a(b)),1)])],2)):T("v-if",!0)],6)],6)],2)):(w(),k("div",{key:1,class:_(a(r).b("circle")),style:x({height:`${p.width}px`,width:`${p.width}px`})},[(w(),k("svg",Ir,[F("path",{class:_(a(r).be("circle","track")),d:a(c),stroke:`var(${a(r).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-width":a(o),fill:"none",style:x(a(y))},null,14,Nr),F("path",{class:_(a(r).be("circle","path")),d:a(c),stroke:a(g),fill:"none",opacity:p.percentage?1:0,"stroke-linecap":p.strokeLinecap,"stroke-width":a(o),style:x(a(u))},null,14,xr)]))],6)),(p.showText||p.$slots.default)&&!p.textInside?(w(),k("div",{key:2,class:_(a(r).e("text")),style:x({fontSize:`${a(v)}px`})},[L(p.$slots,"default",{percentage:p.percentage},()=>[p.status?(w(),O(a(N),{key:1},{default:A(()=>[(w(),O(Ft(a(l))))]),_:1})):(w(),k("span",Mr,Y(a(b)),1))])],6)):T("v-if",!0)],10,Br))}});var qr=X(Kr,[["__file","/home/runner/work/element-plus/element-plus/packages/components/progress/src/progress.vue"]]);const Hr=We(qr),lt=Symbol("uploadContextKey"),Jr="ElUpload";class Wr extends Error{constructor(t,n,r,s){super(t),this.name="UploadAjaxError",this.status=n,this.method=r,this.url=s}}function Be(e,t,n){let r;return n.response?r=`${n.response.error||n.response}`:n.responseText?r=`${n.responseText}`:r=`fail to ${t.method} ${e} ${n.status}`,new Wr(r,n.status,t.method,e)}function Xr(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch{return t}}const zr=e=>{typeof XMLHttpRequest>"u"&&ye(Jr,"XMLHttpRequest is undefined");const t=new XMLHttpRequest,n=e.action;t.upload&&t.upload.addEventListener("progress",o=>{const i=o;i.percent=o.total>0?o.loaded/o.total*100:0,e.onProgress(i)});const r=new FormData;if(e.data)for(const[o,i]of Object.entries(e.data))Array.isArray(i)?r.append(o,...i):r.append(o,i);r.append(e.filename,e.file,e.file.name),t.addEventListener("error",()=>{e.onError(Be(n,e,t))}),t.addEventListener("load",()=>{if(t.status<200||t.status>=300)return e.onError(Be(n,e,t));e.onSuccess(Xr(t))}),t.open(e.method,n,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const s=e.headers||{};if(s instanceof Headers)s.forEach((o,i)=>t.setRequestHeader(i,o));else for(const[o,i]of Object.entries(s))tt(i)||t.setRequestHeader(o,String(i));return t.send(r),t},ut=["text","picture","picture-card"];let Vr=1;const pe=()=>Date.now()+Vr++,ct=H({action:{type:String,default:"#"},headers:{type:S(Object)},method:{type:String,default:"post"},data:{type:Object,default:()=>ce({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},type:{type:String,default:"select"},fileList:{type:S(Array),default:()=>ce([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:ut,default:"text"},httpRequest:{type:S(Function),default:zr},disabled:Boolean,limit:Number}),Yr=H({...ct,beforeUpload:{type:S(Function),default:P},beforeRemove:{type:S(Function)},onRemove:{type:S(Function),default:P},onChange:{type:S(Function),default:P},onPreview:{type:S(Function),default:P},onSuccess:{type:S(Function),default:P},onProgress:{type:S(Function),default:P},onError:{type:S(Function),default:P},onExceed:{type:S(Function),default:P}}),Qr=H({files:{type:S(Array),default:()=>ce([])},disabled:{type:Boolean,default:!1},handlePreview:{type:S(Function),default:P},listType:{type:String,values:ut,default:"text"}}),Zr={remove:e=>!!e},es=["onKeydown"],ts=["src"],ns=["onClick"],rs=["title"],ss=["onClick"],as=["onClick"],os=B({name:"ElUploadList"}),is=B({...os,props:Qr,emits:Zr,setup(e,{emit:t}){const{t:n}=At(),r=G("upload"),s=G("icon"),o=G("list"),i=Z(),c=Xe(!1),h=f=>{t("remove",f)};return(f,m)=>(w(),O(Dt,{tag:"ul",class:_([a(r).b("list"),a(r).bm("list",f.listType),a(r).is("disabled",a(i))]),name:a(o).b()},{default:A(()=>[(w(!0),k(Pt,null,Ct(f.files,y=>(w(),k("li",{key:y.uid||y.name,class:_([a(r).be("list","item"),a(r).is(y.status),{focusing:c.value}]),tabindex:"0",onKeydown:ze(u=>!a(i)&&h(y),["delete"]),onFocus:m[0]||(m[0]=u=>c.value=!0),onBlur:m[1]||(m[1]=u=>c.value=!1),onClick:m[2]||(m[2]=u=>c.value=!1)},[L(f.$slots,"default",{file:y},()=>[f.listType==="picture"||y.status!=="uploading"&&f.listType==="picture-card"?(w(),k("img",{key:0,class:_(a(r).be("list","item-thumbnail")),src:y.url,alt:""},null,10,ts)):T("v-if",!0),y.status==="uploading"||f.listType!=="picture-card"?(w(),k("div",{key:1,class:_(a(r).be("list","item-info"))},[F("a",{class:_(a(r).be("list","item-name")),onClick:K(u=>f.handlePreview(y),["prevent"])},[D(a(N),{class:_(a(s).m("document"))},{default:A(()=>[D(a(Et))]),_:1},8,["class"]),F("span",{class:_(a(r).be("list","item-file-name")),title:y.name},Y(y.name),11,rs)],10,ns),y.status==="uploading"?(w(),O(a(Hr),{key:0,type:f.listType==="picture-card"?"circle":"line","stroke-width":f.listType==="picture-card"?6:2,percentage:Number(y.percentage),style:x(f.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):T("v-if",!0)],2)):T("v-if",!0),F("label",{class:_(a(r).be("list","item-status-label"))},[f.listType==="text"?(w(),O(a(N),{key:0,class:_([a(s).m("upload-success"),a(s).m("circle-check")])},{default:A(()=>[D(a(qe))]),_:1},8,["class"])):["picture-card","picture"].includes(f.listType)?(w(),O(a(N),{key:1,class:_([a(s).m("upload-success"),a(s).m("check")])},{default:A(()=>[D(a(He))]),_:1},8,["class"])):T("v-if",!0)],2),a(i)?T("v-if",!0):(w(),O(a(N),{key:2,class:_(a(s).m("close")),onClick:u=>h(y)},{default:A(()=>[D(a(Je))]),_:2},1032,["class","onClick"])),T(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),T(" This is a bug which needs to be fixed "),T(" TODO: Fix the incorrect navigation interaction "),a(i)?T("v-if",!0):(w(),k("i",{key:3,class:_(a(s).m("close-tip"))},Y(a(n)("el.upload.deleteTip")),3)),f.listType==="picture-card"?(w(),k("span",{key:4,class:_(a(r).be("list","item-actions"))},[F("span",{class:_(a(r).be("list","item-preview")),onClick:u=>f.handlePreview(y)},[D(a(N),{class:_(a(s).m("zoom-in"))},{default:A(()=>[D(a(Lt))]),_:1},8,["class"])],10,ss),a(i)?T("v-if",!0):(w(),k("span",{key:0,class:_(a(r).be("list","item-delete")),onClick:u=>h(y)},[D(a(N),{class:_(a(s).m("delete"))},{default:A(()=>[D(a(Ut))]),_:1},8,["class"])],10,as))],2)):T("v-if",!0)])],42,es))),128)),L(f.$slots,"append")]),_:3},8,["class","name"]))}});var Ie=X(is,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-list.vue"]]);const ls=H({disabled:{type:Boolean,default:!1}}),us={file:e=>Ot(e)},cs=["onDrop","onDragover"],ft="ElUploadDrag",fs=B({name:ft}),ds=B({...fs,props:ls,emits:us,setup(e,{emit:t}){const n=jt(lt);n||ye(ft,"usage: <el-upload><el-upload-dragger /></el-upload>");const r=G("upload"),s=Xe(!1),o=Z(),i=h=>{if(o.value)return;s.value=!1,h.stopPropagation();const f=Array.from(h.dataTransfer.files),m=n.accept.value;if(!m){t("file",f);return}const y=f.filter(u=>{const{type:g,name:l}=u,v=l.includes(".")?`.${l.split(".").pop()}`:"",b=g.replace(/\/.*$/,"");return m.split(",").map(d=>d.trim()).filter(d=>d).some(d=>d.startsWith(".")?v===d:/\/\*$/.test(d)?b===d.replace(/\/\*$/,""):/^[^/]+\/[^/]+$/.test(d)?g===d:!1)});t("file",y)},c=()=>{o.value||(s.value=!0)};return(h,f)=>(w(),k("div",{class:_([a(r).b("dragger"),a(r).is("dragover",s.value)]),onDrop:K(i,["prevent"]),onDragover:K(c,["prevent"]),onDragleave:f[0]||(f[0]=K(m=>s.value=!1,["prevent"]))},[L(h.$slots,"default")],42,cs))}});var ps=X(ds,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-dragger.vue"]]);const hs=H({...ct,beforeUpload:{type:S(Function),default:P},onRemove:{type:S(Function),default:P},onStart:{type:S(Function),default:P},onSuccess:{type:S(Function),default:P},onProgress:{type:S(Function),default:P},onError:{type:S(Function),default:P},onExceed:{type:S(Function),default:P}}),gs=["onKeydown"],ys=["name","multiple","accept"],vs=B({name:"ElUploadContent",inheritAttrs:!1}),ms=B({...vs,props:hs,setup(e,{expose:t}){const n=e,r=G("upload"),s=Z(),o=fe({}),i=fe(),c=l=>{if(l.length===0)return;const{autoUpload:v,limit:b,fileList:d,multiple:j,onStart:p,onExceed:U}=n;if(b&&d.length+l.length>b){U(l,d);return}j||(l=l.slice(0,1));for(const R of l){const C=R;C.uid=pe(),p(C),v&&h(C)}},h=async l=>{if(i.value.value="",!n.beforeUpload)return f(l);let v,b={};try{const j=n.data,p=n.beforeUpload(l);b=Se(n.data)?Re(n.data):n.data,v=await p,Se(n.data)&&sn(j,b)&&(b=Re(n.data))}catch{v=!1}if(v===!1){n.onRemove(l);return}let d=l;v instanceof Blob&&(v instanceof File?d=v:d=new File([v],l.name,{type:l.type})),f(Object.assign(d,{uid:l.uid}),b)},f=(l,v)=>{const{headers:b,data:d,method:j,withCredentials:p,name:U,action:R,onProgress:C,onSuccess:I,onError:bt,httpRequest:_t}=n,{uid:re}=l,se={headers:b||{},withCredentials:p,file:l,data:v??d,method:j,filename:U,action:R,onProgress:J=>{C(J,l)},onSuccess:J=>{I(J,l),delete o.value[re]},onError:J=>{bt(J,l),delete o.value[re]}},ae=_t(se);o.value[re]=ae,ae instanceof Promise&&ae.then(se.onSuccess,se.onError)},m=l=>{const v=l.target.files;v&&c(Array.from(v))},y=()=>{s.value||(i.value.value="",i.value.click())},u=()=>{y()};return t({abort:l=>{Rt(o.value).filter(l?([b])=>String(l.uid)===b:()=>!0).forEach(([b,d])=>{d instanceof XMLHttpRequest&&d.abort(),delete o.value[b]})},upload:h}),(l,v)=>(w(),k("div",{class:_([a(r).b(),a(r).m(l.listType),a(r).is("drag",l.drag)]),tabindex:"0",onClick:y,onKeydown:ze(K(u,["self"]),["enter","space"])},[l.drag?(w(),O(ps,{key:0,disabled:a(s),onFile:c},{default:A(()=>[L(l.$slots,"default")]),_:3},8,["disabled"])):L(l.$slots,"default",{key:1}),F("input",{ref_key:"inputRef",ref:i,class:_(a(r).e("input")),name:l.name,multiple:l.multiple,accept:l.accept,type:"file",onChange:m,onClick:v[0]||(v[0]=K(()=>{},["stop"]))},null,42,ys)],42,gs))}});var Ne=X(ms,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-content.vue"]]);const xe="ElUpload",bs=e=>{var t;(t=e.url)!=null&&t.startsWith("blob:")&&URL.revokeObjectURL(e.url)},_s=(e,t)=>{const n=Bt(e,"fileList",void 0,{passive:!0}),r=u=>n.value.find(g=>g.uid===u.uid);function s(u){var g;(g=t.value)==null||g.abort(u)}function o(u=["ready","uploading","success","fail"]){n.value=n.value.filter(g=>!u.includes(g.status))}const i=(u,g)=>{const l=r(g);l&&(console.error(u),l.status="fail",n.value.splice(n.value.indexOf(l),1),e.onError(u,l,n.value),e.onChange(l,n.value))},c=(u,g)=>{const l=r(g);l&&(e.onProgress(u,l,n.value),l.status="uploading",l.percentage=Math.round(u.percent))},h=(u,g)=>{const l=r(g);l&&(l.status="success",l.response=u,e.onSuccess(u,l,n.value),e.onChange(l,n.value))},f=u=>{tt(u.uid)&&(u.uid=pe());const g={name:u.name,percentage:0,status:"ready",size:u.size,raw:u,uid:u.uid};if(e.listType==="picture-card"||e.listType==="picture")try{g.url=URL.createObjectURL(u)}catch(l){an(xe,l.message),e.onError(l,g,n.value)}n.value=[...n.value,g],e.onChange(g,n.value)},m=async u=>{const g=u instanceof File?r(u):u;g||ye(xe,"file to be removed not found");const l=v=>{s(v);const b=n.value;b.splice(b.indexOf(v),1),e.onRemove(v,b),bs(v)};e.beforeRemove?await e.beforeRemove(g,n.value)!==!1&&l(g):l(g)};function y(){n.value.filter(({status:u})=>u==="ready").forEach(({raw:u})=>{var g;return u&&((g=t.value)==null?void 0:g.upload(u))})}return Te(()=>e.listType,u=>{u!=="picture-card"&&u!=="picture"||(n.value=n.value.map(g=>{const{raw:l,url:v}=g;if(!v&&l)try{g.url=URL.createObjectURL(l)}catch(b){e.onError(b,g,n.value)}return g}))}),Te(n,u=>{for(const g of u)g.uid||(g.uid=pe()),g.status||(g.status="success")},{immediate:!0,deep:!0}),{uploadFiles:n,abort:s,clearFiles:o,handleError:i,handleProgress:c,handleStart:f,handleSuccess:h,handleRemove:m,submit:y}},ws=B({name:"ElUpload"}),$s=B({...ws,props:Yr,setup(e,{expose:t}){const n=e,r=It(),s=Z(),o=fe(),{abort:i,submit:c,clearFiles:h,uploadFiles:f,handleStart:m,handleError:y,handleRemove:u,handleSuccess:g,handleProgress:l}=_s(n,o),v=E(()=>n.listType==="picture-card"),b=E(()=>({...n,fileList:f.value,onStart:m,onProgress:l,onSuccess:g,onError:y,onRemove:u}));return Nt(()=>{f.value.forEach(({url:d})=>{d!=null&&d.startsWith("blob:")&&URL.revokeObjectURL(d)})}),xt(lt,{accept:Mt(n,"accept")}),t({abort:i,submit:c,clearFiles:h,handleStart:m,handleRemove:u}),(d,j)=>(w(),k("div",null,[a(v)&&d.showFileList?(w(),O(Ie,{key:0,disabled:a(s),"list-type":d.listType,files:a(f),"handle-preview":d.onPreview,onRemove:a(u)},ke({append:A(()=>[D(Ne,Fe({ref_key:"uploadRef",ref:o},a(b)),{default:A(()=>[a(r).trigger?L(d.$slots,"trigger",{key:0}):T("v-if",!0),!a(r).trigger&&a(r).default?L(d.$slots,"default",{key:1}):T("v-if",!0)]),_:3},16)]),_:2},[d.$slots.file?{name:"default",fn:A(({file:p})=>[L(d.$slots,"file",{file:p})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):T("v-if",!0),!a(v)||a(v)&&!d.showFileList?(w(),O(Ne,Fe({key:1,ref_key:"uploadRef",ref:o},a(b)),{default:A(()=>[a(r).trigger?L(d.$slots,"trigger",{key:0}):T("v-if",!0),!a(r).trigger&&a(r).default?L(d.$slots,"default",{key:1}):T("v-if",!0)]),_:3},16)):T("v-if",!0),d.$slots.trigger?L(d.$slots,"default",{key:2}):T("v-if",!0),L(d.$slots,"tip"),!a(v)&&d.showFileList?(w(),O(Ie,{key:3,disabled:a(s),"list-type":d.listType,files:a(f),"handle-preview":d.onPreview,onRemove:a(u)},ke({_:2},[d.$slots.file?{name:"default",fn:A(({file:p})=>[L(d.$slots,"file",{file:p})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):T("v-if",!0)]))}});var Ss=X($s,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload.vue"]]);const Ts=We(Ss);function ks(){return this._array=null,Promise.resolve()}function Fs(){var e=this._array;return this._array=null,Promise.resolve(e?{done:!1,value:e}:{done:!0,value:void 0})}function te(e){return new be(e instanceof Uint8Array?e:new Uint8Array(e))}function be(e){this._array=e}be.prototype.read=Fs;be.prototype.cancel=ks;function As(e){return fetch(e).then(function(t){return t.body&&t.body.getReader?t.body.getReader():t.arrayBuffer().then(te)})}function Ps(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.responseType="arraybuffer",r.onload=function(){t(te(r.response))},r.onerror=n,r.ontimeout=n,r.open("GET",e,!0),r.send()})}function dt(e){return(typeof fetch=="function"?As:Ps)(e)}function pt(e){return typeof e.read=="function"?e:e.getReader()}const _e=new Uint8Array(0);function Cs(){return this._source.cancel()}function Es(e,t){if(!e.length)return t;if(!t.length)return e;var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}function Ls(){var e=this,t=e._array.subarray(e._index);return e._source.read().then(function(n){return e._array=_e,e._index=0,n.done?t.length>0?{done:!1,value:t}:{done:!0,value:void 0}:{done:!1,value:Es(t,n.value)}})}function Us(e){if((e|=0)<0)throw new Error("invalid length");var t=this,n=this._array.length-this._index;if(this._index+e<=this._array.length)return Promise.resolve(this._array.subarray(this._index,this._index+=e));var r=new Uint8Array(e);return r.set(this._array.subarray(this._index)),function s(){return t._source.read().then(function(o){return o.done?(t._array=_e,t._index=0,n>0?r.subarray(0,n):null):n+o.value.length>=e?(t._array=o.value,t._index=e-n,r.set(o.value.subarray(0,e-n),n),r):(r.set(o.value,n),n+=o.value.length,s())})}()}function ht(e){return typeof e.slice=="function"?e:new ne(typeof e.read=="function"?e:e.getReader())}function ne(e){this._source=e,this._array=_e,this._index=0}ne.prototype.read=Ls;ne.prototype.slice=Us;ne.prototype.cancel=Cs;function Ds(){return this._source.cancel()}function Os(e){return/^[nf]$/i.test(e)?!1:/^[yt]$/i.test(e)?!0:null}function js(e){return new Date(+e.substring(0,4),e.substring(4,6)-1,+e.substring(6,8))}function z(e){return!(e=e.trim())||isNaN(e=+e)?null:e}function Rs(e){return e.trim()||null}var Bs={B:z,C:Rs,D:js,F:z,L:Os,M:z,N:z};function Is(){var e=this,t=1;return e._source.slice(e._recordLength).then(function(n){return n&&n[0]!==26?{done:!1,value:e._fields.reduce(function(r,s){return r[s.name]=Bs[s.type](e._decode(n.subarray(t,t+=s.length))),r},{})}:{done:!0,value:void 0}})}function q(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ns(e,t){return e=ht(e),e.slice(32).then(function(n){var r=q(n);return e.slice(r.getUint16(8,!0)-32).then(function(s){return new gt(e,t,r,q(s))})})}function gt(e,t,n,r){this._source=e,this._decode=t.decode.bind(t),this._recordLength=n.getUint16(10,!0),this._fields=[];for(var s=0;r.getUint8(s)!==13;s+=32){for(var o=0;o<11&&r.getUint8(s+o)!==0;++o);this._fields.push({name:this._decode(new Uint8Array(r.buffer,r.byteOffset+s,o)),type:String.fromCharCode(r.getUint8(s+11)),length:r.getUint8(s+16)})}}var yt=gt.prototype;yt.read=Is;yt.cancel=Ds;function xs(){return this._source.cancel()}function oe(e){var t=40,n,r=e.getInt32(36,!0),s=new Array(r);for(n=0;n<r;++n,t+=16)s[n]=[e.getFloat64(t,!0),e.getFloat64(t+8,!0)];return{type:"MultiPoint",coordinates:s}}function Ms(){return null}function ie(e){return{type:"Point",coordinates:[e.getFloat64(4,!0),e.getFloat64(12,!0)]}}function le(e){var t=44,n,r=e.getInt32(36,!0),s=e.getInt32(40,!0),o=new Array(r),i=new Array(s),c=[],h=[];for(n=0;n<r;++n,t+=4)o[n]=e.getInt32(t,!0);for(n=0;n<s;++n,t+=16)i[n]=[e.getFloat64(t,!0),e.getFloat64(t+8,!0)];return o.forEach(function(f,m){var y=i.slice(f,o[m+1]);Gs(y)?c.push([y]):h.push(y)}),h.forEach(function(f){c.some(function(m){if(Ks(m[0],f))return m.push(f),!0})||c.push([f])}),c.length===1?{type:"Polygon",coordinates:c[0]}:{type:"MultiPolygon",coordinates:c}}function Gs(e){if((n=e.length)<4)return!1;for(var t=0,n,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r>=0}function Ks(e,t){for(var n=-1,r=t.length,s;++n<r;)if(s=qs(e,t[n]))return s>0;return!1}function qs(e,t){for(var n=t[0],r=t[1],s=-1,o=0,i=e.length,c=i-1;o<i;c=o++){var h=e[o],f=h[0],m=h[1],y=e[c],u=y[0],g=y[1];if(Hs(h,y,t))return 0;m>r!=g>r&&n<(u-f)*(r-m)/(g-m)+f&&(s=-s)}return s}function Hs(e,t,n){var r=n[0]-e[0],s=n[1]-e[1];if(r===0&&s===0)return!0;var o=t[0]-e[0],i=t[1]-e[1];if(o===0&&i===0)return!1;var c=(r*o+s*i)/(o*o+i*i);return c<0||c>1?!1:c===0||c===1?!0:c*o===r&&c*i===s}function ue(e){var t=44,n,r=e.getInt32(36,!0),s=e.getInt32(40,!0),o=new Array(r),i=new Array(s);for(n=0;n<r;++n,t+=4)o[n]=e.getInt32(t,!0);for(n=0;n<s;++n,t+=16)i[n]=[e.getFloat64(t,!0),e.getFloat64(t+8,!0)];return r===1?{type:"LineString",coordinates:i}:{type:"MultiLineString",coordinates:o.map(function(c,h){return i.slice(c,o[h+1])})}}function Me(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e,0),n.set(t,e.length),n}function Js(){var e=this;return++e._index,e._source.slice(12).then(function(t){if(t==null)return{done:!0,value:void 0};var n=q(t);function r(){return e._source.slice(4).then(function(o){return o==null?{done:!0,value:void 0}:(n=q(t=Me(t.slice(4),o)),n.getInt32(0,!1)!==e._index?r():s())})}function s(){var o=n.getInt32(4,!1)*2-4,i=n.getInt32(8,!0);return o<0||i&&i!==e._type?r():e._source.slice(o).then(function(c){return{done:!1,value:i?e._parse(q(Me(t.slice(8),c))):null}})}return s()})}var Ge={0:Ms,1:ie,3:ue,5:le,8:oe,11:ie,13:ue,15:le,18:oe,21:ie,23:ue,25:le,28:oe};function Ws(e){return e=ht(e),e.slice(100).then(function(t){return new vt(e,q(t))})}function vt(e,t){var n=t.getInt32(32,!0);if(!(n in Ge))throw new Error("unsupported shape type: "+n);this._source=e,this._type=n,this._index=0,this._parse=Ge[n],this.bbox=[t.getFloat64(36,!0),t.getFloat64(44,!0),t.getFloat64(52,!0),t.getFloat64(60,!0)]}var mt=vt.prototype;mt.read=Js;mt.cancel=xs;function Xs(e,t){return typeof e=="string"?(/\.shp$/.test(e)||(e+=".shp"),e=dt(e)):e instanceof ArrayBuffer||e instanceof Uint8Array?e=te(e):e=pt(e),Promise.resolve(e).then(Ws)}function zs(e,t){var n="windows-1252";return t&&t.encoding!=null&&(n=t.encoding),n=new TextDecoder(n),typeof e=="string"?(/\.dbf$/.test(e)||(e+=".dbf"),e=dt(e)):e instanceof ArrayBuffer||e instanceof Uint8Array?e=te(e):e=pt(e),Promise.resolve(e).then(function(r){return Ns(r,n)})}const Vs=e=>(e&&Object.keys(e).forEach(t=>{t!==t.toLowerCase()&&(e[t.toLowerCase()]=e[t],delete e[t])}),e);class Ys{constructor(){this.init()}init(){this.shpData=[],this.dbfData=[],this.geojsonData={}}getShpFile(t,n){this.shpData=[];const r=this;if(t)if(t.name.split(".")[1]=="shp"){const i=new FileReader,c=t.raw;i.onload=()=>{Xs(i.result).then(h=>{h.read().then(function f(m){if(m.done){typeof n=="function"&&n(r.shpData);return}else return r.shpData.push(m.value),h.read().then(f)})})},i.readAsArrayBuffer(c)}else alert("文件不是shp文件！请重新选择文件",{confirmButtonText:"确定"})}getDbfFile(t,n){this.dbfData=[];const r=this;if(t)if(t.name.split(".")[1]=="dbf"){const i=new FileReader,c=t.raw;i.onload=()=>{zs(i.result,{encoding:"utf-8"}).then(h=>{h.read().then(function f(m){if(m.done){typeof n=="function"&&n(r.dbfData);return}else return r.dbfData.push(m.value),h.read().then(f)})})},i.readAsArrayBuffer(c)}else alert("文件不是dbf文件！请重新选择文件",{confirmButtonText:"确定"})}getShpFileAsync(t){return new Promise((n,r)=>{try{this.getShpFile(t,s=>{n(s)})}catch(s){r(s)}})}getDbfFileAsync(t){return new Promise((n,r)=>{try{this.getDbfFile(t,s=>{console.log(s,"ddede"),n(s)})}catch(s){r(s)}})}async solveGISData(t,n){let r=[];for(let s=0;s<t.length;s++)t[s].name.split(".")[1]=="shp"?r.push(this.getShpFileAsync(t[s])):t[s].name.split(".")[1]=="dbf"&&r.push(this.getDbfFileAsync(t[s]));Promise.all(r).then(()=>{typeof n=="function"&&n(this.shpData,this.dbfData)}).catch(s=>{console.error(s)})}toGeoJSON(t,n){console.log(n,"的记得"),this.geojsonData={type:"FeatureCollection",features:[]};for(let r=0,s=t.length;r<s;r++){const o=Vs(n[r]),i={geometry:t[r],properties:o};this.geojsonData.features[r]=i}return this.geojsonData}}const Qs=`当处理地理空间数据时,常见的文件名后缀(扩展名)用于标识不同类型的文件和数据格式。以下是一些常见的地理空间数据文件名及其作用的解释:

<br> 1.shp(Shapefile):.shp是Shapefile的主文件,它包含几何图形的几何类型和坐标信息。它是Esri公司ArcGIS软件中广泛使用的一种矢量数据格式,可以表示点、线、面等几何要素。

<br>2.shx(Shapefile Index):.shx文件是Shapefile的索引文件,它包含了几何要素在.shp文件中的偏移量和长度信息。这个索引文件帮助快速访问.shp文件中的要素。

<br>3.dbf(dBASE文件):.dbf文件是Shapefile的属性数据文件,使用dBASE格式存储属性信息。它包含与几何要素相关联的属性数据,如地名、人口数量、地区代码等。

<br>4.prj(投影文件):.prj文件包含了Shapefile使用的坐标系和投影信息。它描述了地理坐标数据的参考系统,以便正确地将地理位置与地球表面上的位置相对应。

<br>5.kml(Keyhole Markup Language):.kml文件是一种用于描述地理数据的XML格式。它常用于Google Earth等地理信息系统中,可以包含点、线、面、标签等地理要素,并支持添加附加信息和样式。

<br>6.kmz(Keyhole Markup Language压缩文件):.kmz文件是对.kml文件进行压缩和打包的文件格式。它将.kml文件和相关的资源(如图像、模型等)打包在一起,方便共享和传输。

<br>7.geojson(Geographic JavaScript Object Notation):.geojson文件是一种基于JSON格式的地理空间数据表示标准。它可以包含点、线、面等地理要素,并携带属性数据。

这些文件名及其对应的文件格式在地理信息系统(GIS)中广泛使用,用于存储、传输和共享地理空间数据。不同的文件名后缀通常指示了数据的类型、结构和格式,以便正确解释和处理地理空间数据。`;let W,M;const Zs={components:{UploadFilled:Kt},methods:{readShpFile(e,t){M=t}},setup(){qt(()=>{W=new Ys});const e=()=>{if(M&&M.length>0){const s=M.filter(i=>i.name.split(".")[1]=="shp"),o=M.filter(i=>i.name.split(".")[1]=="dbf");if(s.length==0)return alert("请上传shp文件"),!1;if(s.length>1)return alert("请删除多余的shp文件,只保留一个"),!1;if(o.length==0)return alert("您未上传dbf的文件,可能会导致导出的数据只包含轮廓信息"),!0;if(o.length>1)return alert("请删除多余的dbf文件,只保留一个"),!1;if(o.length==1)return!0}else return alert("请上传你的文件"),!1};return{startSolve:()=>{e()&&W.solveGISData(M,(s,o)=>{W.toGeoJSON(s,o),Jt(W.geojsonData)})},exportGeoJSON:()=>{const s=W.geojsonData,o=JSON.stringify(s),i=new Blob([o],{type:"application/json"}),c=URL.createObjectURL(i),h=document.createElement("a");h.href=c,h.download="solveData.geojson",h.click(),URL.revokeObjectURL(c)},clickTips:()=>{Wt.alert(` <h3>gis文件相关知识点补充</h3>
      <div
        style="
  width:100%;
          overflow: auto;
          font-family: 'Courier New', Courier, monospace;
          font-size: small;
        "
      >
        ${Qs}
      </div>`,"tip",{dangerouslyUseHTMLString:!0})}}}},ea={class:"shpSolverParentContainer"},ta=F("div",{class:"el-upload__text",style:{color:"white"}},[de(" 鼠标拖拽.shp和.dbf文件到方框内或者 "),F("em",{style:{color:"rgb(60, 255, 0)"}},"点击来读取本地文件（可多选）")],-1),na=F("div",{class:"el-upload__tip",style:{color:"rgb(224, 224, 224)"}},[de(" Ps:本工具不会上传数据到云端，请放心使用，(其他格式请等待后续支持)"),F("br"),de(" tip:只能上传一个shp和一个dbf数据 ")],-1),ra=F("br",null,null,-1);function sa(e,t,n,r,s,o){const i=Ht("upload-filled"),c=N,h=Ts;return w(),k("div",ea,[D(h,{class:"upload-demo",drag:"",action:"   ","on-change":o.readShpFile,"auto-upload":!1,multiple:!0,accept:".shp,.dbf"},{tip:A(()=>[na]),default:A(()=>[D(c,{class:"el-icon--upload"},{default:A(()=>[D(i)]),_:1}),ta]),_:1},8,["on-change","accept"]),F("button",{onClick:t[0]||(t[0]=(...f)=>r.startSolve&&r.startSolve(...f))},"转化成geojson"),F("button",{onClick:t[1]||(t[1]=(...f)=>r.exportGeoJSON&&r.exportGeoJSON(...f))},"导出geojson"),F("button",{onClick:t[2]||(t[2]=(...f)=>r.clickTips&&r.clickTips(...f))},"gis小知识"),ra])}const ca=Gt(Zs,[["render",sa]]);export{ca as default};
